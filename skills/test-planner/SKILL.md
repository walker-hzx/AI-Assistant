---
name: test-planner
description: 测试设计专家。在编写 E2E 测试前使用，分析需求、梳理页面功能、设计测试场景和测试用例。
disable-model-invocation: false
---

# 测试设计专家

在编写测试代码前，分析需求和当前页面功能，设计完整的测试场景和测试用例。

## 使用时机

- 开始为某个功能编写 E2E 测试前
- 需要梳理复杂业务逻辑时
- 设计测试策略和覆盖范围时

## 工作流程

### 1. 需求分析

读取相关需求文档，提取关键信息：

- 功能模块名称
- 业务规则
- 用户操作流程
- 边界条件和异常情况

**查找需求文档：**
```bash
# 查找需求目录下的相关文档
ls docs/requirements/
ls docs/plans/
```

### 2. 页面功能梳理

检查当前页面实现，梳理实际功能：

- 页面结构（表单、表格、按钮等）
- 交互流程（点击、弹窗、跳转）
- 数据流向（API 调用、状态管理）
- 现有功能完整度

**需要检查的要点：**

| 检查项 | 说明 |
|--------|------|
| 列表页 | 是否有分页、搜索、筛选 |
| 表单页 | 字段校验规则、提交方式 |
| 操作按钮 | 新增、编辑、删除、批量操作 |
| 状态流转 | 状态变更的条件和限制 |

### 3. 测试场景设计

基于需求和页面功能，设计测试场景：

#### 正常场景（Happy Path）
- 标准操作流程
- 正常数据输入
- 预期结果验证

#### 异常场景（Error Cases）
- 无效输入处理
- 权限不足场景
- 网络/服务异常

#### 边界场景（Edge Cases）
- 空值/极限值
- 大数据量处理
- 并发操作

### 4. 测试用例输出

生成结构化的测试计划文档：

```markdown
## 测试计划：[功能名称]

### 功能概述
简要描述该功能的作用和范围。

### 页面功能清单

| 页面 | 功能点 | 状态 |
|------|--------|------|
| 列表页 | 分页 | ✅ 已实现 |
| 列表页 | 搜索 | ✅ 已实现 |
| 列表页 | 批量删除 | ⚠️ 未实现 |
| 表单页 | 字段校验 | ✅ 已实现 |

### 测试场景

#### 场景 1: [名称]
- **前置条件**: xxx
- **操作步骤**:
  1. xxx
  2. xxx
- **预期结果**: xxx

#### 场景 2: [名称]
...

### 测试数据准备

| 数据项 | 值 | 用途 |
|--------|-----|------|
| 测试租户 | `test-tenant-{timestamp}` | 创建测试 |
| 无效 ID | `invalid-id` | 异常测试 |

### 实现建议

- 使用页面对象模式
- 注意数据清理
- 建议使用 try-finally 确保清理
```

## 输出位置

将测试计划保存到：
```
docs/plans/YYYY-MM-DD-[feature]-test-plan.md
```

## 与其他工具的协作

- **test-planner**（本工具）→ 分析设计
- **e2e-runner**（Agent）→ 执行实现

流程：
1. 使用 test-planner 设计测试
2. 查看测试计划确认
3. 使用 e2e-runner 实现测试代码
